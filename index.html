<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sprout's Website</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- 网站内容 -->
    <div class="typing typing-tittle-small">Welcome to</div>
    <div class="typing typing-tittle-large">Sprout's</div>
    <div class="typing typing-tittle-small">personal website</div>
    <div class="typing typing-body-mid">··································</div>
    <div class="typing typing-body-mid" data-printonebyone="true" data-iinterval="25">Here's a place to share my thoughts and ideas with the world.</div>
    <div class="typing typing-body-mid" data-printonebyone="true" data-iinterval="25">Do you know why this website is called 'sprotistuffy'?</div>
    <div class="typing typing-body-mid" data-printonebyone="true" data-iinterval="25">Because my previous name was Luffy, but now my name is Sprout</div>

    <script>
        /**
         * 为指定元素添加打字效果
         * @param {HTMLElement} element - 需要添加打字效果的元素
         * @returns {Promise} - 返回一个Promise，在打字效果完成时解决
         */
        function typeText(element) {
            return new Promise((resolve) => {
                const text = element.textContent; // 获取元素的文本内容
                const printonebyone = element.dataset.printonebyone === 'true'; // 检查是否需要逐字打印
                const iInterval = parseInt(element.dataset.iinterval) || 100; // 获取打字间隔，默认为100ms

                if (printonebyone) {
                    element.textContent = ''; // 清空元素内容
                    element.style.visibility = 'visible'; // 使元素可见
                    let index = 0; // 当前打字的字符索引

                    function addLetter() {
                        if (index < text.length) {
                            const span = document.createElement('span'); // 创建新的span元素
                            span.textContent = text[index]; // 设置span的文本为当前字符
                            span.className = 'fade-in'; // 添加淡入效果类
                            element.appendChild(span); // 将span添加到元素中
                            setTimeout(() => span.style.opacity = '1', iInterval); // 延迟50ms后使字符可见
                            index++; // 移动到下一个字符
                            setTimeout(addLetter, iInterval); // 设置下一个字符的打字延迟
                        } else {
                            resolve(); // 打字效果完成，解决Promise
                        }
                    }

                    addLetter(); // 开始打字效果
                } else {
                    resolve(); // 如果不需要逐字打印，直接解决Promise
                }
            });
        }

        /**
         * 为所有具有.typing类的元素添加打字效果
         */
        async function typeAllText() {
            const typingElements = document.querySelectorAll('.typing'); // 获取所有.typing元素
            for (const element of typingElements) {
                await typeText(element); // 为每个元素添加打字效果，并等待完成
            }
        }

        // 当DOM内容加载完成后，开始执行打字效果
        document.addEventListener('DOMContentLoaded', typeAllText);
    </script>
</body>
</html>
